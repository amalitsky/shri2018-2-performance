const qs=e=>document.querySelector(e),qsAll=e=>document.querySelectorAll(e),output=qs(".modal__value");qs(".adjust-bar.adjust-bar_theme_temp").oninput=function(){output.innerHTML=this.value>0?"+"+this.value:this.value};const arrowLeftDevs=qs(".devices__paginator .paginator__arrow_left"),arrowRightDevs=qs(".devices__paginator .paginator__arrow_right"),devices=qs(".devices");let currentPageDevs=1;const disabledPaginatorArrowClass="paginator__arrow_disabled";let curValue,curRotate;arrowRightDevs.addEventListener("click",()=>{currentPageDevs+=1,arrowLeftDevs.classList.toggle("paginator__arrow_disabled",1===currentPageDevs),devices.scroll({top:0,left:1366,behavior:"smooth"})}),arrowLeftDevs.addEventListener("click",()=>{currentPageDevs>1&&(currentPageDevs-=1,arrowLeftDevs.classList.toggle("paginator__arrow_disabled",1===currentPageDevs),devices.scroll({top:0,left:-1366,behavior:"smooth"}))});const maxRotate=.42,minRotate=-.42,MIN_VALUE=26,INDICATOR_OFFSET=265,rotateToValue=function(e){return Math.floor(Math.abs(360*e*1.73+INDICATOR_OFFSET)/53+26)};function setRotate(e){e>maxRotate?e=maxRotate:e<minRotate&&(e=minRotate),curRotate=e,curValue=rotateToValue(e),qs(".modal_knob .modal__value").innerHTML="+"+curValue,qs(".knob__value").innerHTML="+"+curValue,qs(".knob__indicator").style.strokeDasharray=360*curRotate*1.73+INDICATOR_OFFSET+" 629",qs(".knob__arrow").style.transform="rotate("+360*curRotate+"deg)"}function getPosition(e){const t=e.getBoundingClientRect();return[t.left+(t.right-t.left)/2,t.top+(t.bottom-t.top)/2]}function getMouseAngle(e,t){const o=getPosition(t);let a,s=[e.clientX,e.clientY];const{targetTouches:n}=e;return n&&n[0]&&(s=[n[0].clientX,n[0].clientY]),a=Math.atan2(s[1]-o[1],s[0]-o[0]),a+=Math.PI/2}let knobDragged,prevAngleRad=null,prevRotate=null;function startDragging(e){e.preventDefault(),e.stopPropagation();const t=getMouseAngle(e,qs(".knob_center"));knobDragged=!0,prevAngleRad=t,prevRotate=curRotate}function stopDragging(){knobDragged=!1}function dragRotate(e){if(!knobDragged)return;const t=prevAngleRad,o=getMouseAngle(e,qs(".knob_center"));let a=o-t;prevAngleRad=o,a<0&&(a+=2*Math.PI),a>Math.PI&&(a-=2*Math.PI);const s=a/Math.PI/2,n=prevRotate+s;prevRotate=n,setRotate(n)}function setEvtListeners(){const e=qs(".knob-container");e.addEventListener("mousedown",startDragging),document.addEventListener("mouseup",stopDragging),document.addEventListener("mousemove",dragRotate),e.addEventListener("touchstart",startDragging),document.addEventListener("touchend",stopDragging),document.addEventListener("touchmove",dragRotate)}setEvtListeners(),setRotate(0),qsAll(".modal_close").forEach(e=>e.onclick=(()=>{qsAll(".modal").forEach(e=>{e.classList.toggle("modal_open",!1),qs("body").style.overflow="auto"})}));const TEMPS={manual:-10,cold:0,warm:23,hot:30};qsAll(".modal__filter .filter__item-label").forEach(e=>e.onclick=function(){qs(".adjust-bar_theme_temp").value=TEMPS[this.id],qs(".modal_temp .modal__value").innerHTML=TEMPS[this.id]>0?"+"+TEMPS[this.id]:TEMPS[this.id]});const showModal=e=>{qs(e).classList.toggle("modal_open",!0),qs("body").style.overflow="hidden"},arrowLeftScens=qs(".scenarios__paginator .paginator__arrow_left"),arrowRightScens=qs(".scenarios__paginator .paginator__arrow_right"),pageCountScens=qsAll(".scenarios__page").length,scenarios=qs(".scenarios");let currentPage=1;arrowRightScens.addEventListener("click",()=>{currentPage<pageCountScens&&(currentPage+=1,arrowRightScens.classList.toggle("paginator__arrow_disabled",currentPage===pageCountScens),arrowLeftScens.classList.toggle("paginator__arrow_disabled",1===currentPage),scenarios.scroll({top:0,left:645,behavior:"smooth"}))}),arrowLeftScens.addEventListener("click",()=>{currentPage>1&&(currentPage-=1,arrowRightScens.classList.toggle("paginator__arrow_disabled",currentPage===pageCountScens),arrowLeftScens.classList.toggle("paginator__arrow_disabled",1===currentPage),scenarios.scroll({top:0,left:-645,behavior:"smooth"}))}),setTimeout(()=>qs("#banner").src="assets/banner-small.webp",99);const infoBlockTemplateSelector="#panel-template",infoBlockClassName="panel",infoBlockSelector=`.${infoBlockClassName}`;function addInfoBlock(e,t){const o=qs(infoBlockTemplateSelector),a=document.importNode(o.content,!0);renderInfoBlock(a,e),t.appendChild(a)}function renderInfoBlock(e,{title:t,iconClass:o,msg:a,types:s}){e.querySelector(`${infoBlockSelector}__title`).textContent=t,e.querySelector(`${infoBlockSelector}__icon`).classList.add(`${infoBlockClassName}__icon_${o}`);const n=e.querySelector(`${infoBlockSelector}__sub`);if(a?n.textContent=a:n.parentNode.removeChild(n),s){const t=e.querySelector(infoBlockSelector);s.forEach(e=>t.classList.add(`${infoBlockClassName}_${e}`))}}const panelGroups={main__upcoming:[{iconClass:"temp_off",title:"Philips Cooler",msg:"Начнет охлаждать в 16:30"},{iconClass:"light_off",title:"Xiaomi Yeelight LED Smart Bulb",msg:"Включится в 17:00"},{iconClass:"light_off",title:"Xiaomi Yeelight LED Smart Bulb",msg:"Включится в 17:00"}],scenarios__page_1:[{iconClass:"light_on",title:"Выключить весь свет в доме и во дворе"},{iconClass:"clock",title:"Я ухожу"},{iconClass:"light_on",title:"Включить свет в корридоре"},{iconClass:"temp_on",title:"Набрать горячую ванну",msg:"Начнётся в 18:00"},{iconClass:"light_on",title:"Выключить весь свет в доме и во дворе"},{iconClass:"clock",title:"Я ухожу"},{iconClass:"light_on",title:"Включить свет в корридоре"},{iconClass:"temp_on",title:"Набрать горячую ванну",msg:"Начнётся в 18:00"},{iconClass:"light_on",title:"Выключить весь свет в доме и во дворе"}],scenarios__page_2:[{iconClass:"light_on",title:"Включить свет в корридоре"}],devices:[{types:["room","floor"],iconClass:"light_on",title:"Xiaomi Warm Floor",msg:"Включено"},{types:["lamp"],iconClass:"light_on",title:"Xiaomi Yeelight LED Smart Bulb",msg:"Включено"},{types:["cam"],iconClass:"light_off",title:"D-Link Omna 180 Cam",msg:"Включится в 17:00"},{types:["room","temp"],iconClass:"temp_off",title:"Elgato Eve Degree Connected",msg:"Включится в 17:00"},{types:["lamp"],iconClass:"light_off",title:"LIFX Mini Day & Dusk A60 E27",msg:"Включится в 17:00"},{types:["room"],iconClass:"light_on",title:"Xiaomi Mi Air Purifier 2S",msg:"Включено"},{types:["lamp"],iconClass:"light_off",title:"Philips Zhirui",msg:"Выключено"},{types:["kitchen"],iconClass:"light_on",title:"Philips Purifier",msg:"Включено"}]};Object.keys(panelGroups).forEach(e=>{const t=panelGroups[e],o=qs(`.${e}`);t.forEach(e=>addInfoBlock(e,o))});const bannerCard=qs("#extra-panel");bannerCard.parentNode.appendChild(bannerCard);const panelCountScens=qsAll(".scenarios__page .panel").length,pagiantorScens=qs(".scenarios__paginator");pagiantorScens.classList.toggle("paginator_hide",panelCountScens<=9);const panelCountDevs=qsAll(".devices .panel").length,pagiantorDevs=qs(".devices__paginator");pagiantorDevs.classList.toggle("paginator_hide",panelCountDevs<7),qsAll(".panel_temp").forEach(e=>e.onclick=(()=>showModal(".modal_temp"))),qsAll(".panel_lamp").forEach(e=>e.onclick=(()=>showModal(".modal_light"))),qsAll(".panel_floor").forEach(e=>e.onclick=(()=>showModal(".modal_knob")));